% my quats are stored w xi yj zk

function q = quat_mult(q0,q1)
   
q = [ q0(1)*q1(1) - q0(2)*q1(2) - q0(3)*q1(3) - q0(4)*q1(4);
      q0(1)*q1(2) + q0(2)*q1(1) + q0(3)*q1(4) - q0(4)*q1(3);
      q0(1)*q1(3) - q0(2)*q1(4) + q0(3)*q1(1) + q0(4)*q1(2);
      q0(1)*q1(4) + q0(2)*q1(3) - q0(3)*q1(2) + q0(4)*q1(1)];

%q = [ q0(4)*q1(1) + q0(1)*q1(4) + q0(2)*q1(3) - q0(3)*q1(2);
%      q0(4)*q1(2) + q0(2)*q1(4) + q0(3)*q1(1) - q0(1)*q1(3);
%      q0(4)*q1(3) + q0(3)*q1(4) + q0(1)*q1(2) - q0(2)*q1(1);
%      q0(4)*q1(4) - q0(1)*q1(1) - q0(2)*q1(2) - q0(3)*q1(3)];

